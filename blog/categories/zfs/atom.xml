<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: zfs | stafwag Blog]]></title>
  <link href="http://stafwag.github.io/blog/blog/categories/zfs/atom.xml" rel="self"/>
  <link href="http://stafwag.github.io/blog/"/>
  <updated>2013-10-20T10:25:26+02:00</updated>
  <id>http://stafwag.github.io/blog/</id>
  <author>
    <name><![CDATA[staf wagemakers]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[yum update on fedora 19 and zfs on linux]]></title>
    <link href="http://stafwag.github.io/blog/blog/2013/10/13/yum-update-on-fedora-19-and-zfs-on-linux/"/>
    <updated>2013-10-13T17:51:00+02:00</updated>
    <id>http://stafwag.github.io/blog/blog/2013/10/13/yum-update-on-fedora-19-and-zfs-on-linux</id>
    <content type="html"><![CDATA[<p><img class="left" src="http://zfsonlinux.org/images/zfs-linux.png" width="200" height="125" title="&#34;zfs on linux&#34;" alt="&#34;zfs on linux&#34;"></p>

<p>I use  <a href="http://zfsonlinux.org/"> zfs on linux</a> on <a href="http://fedoraproject.org/">fedora</a> now.</p>

<p><a href="http://zfsonlinux.org/fedora.html">The installation</a> was pretty straightforward but after the installation of <a href="http://open-zfs.org/">zfs</a> <code>yum update</code> failed.</p>

<br />


<p>```
[root@vicky etc]# yum update -y
Loaded plugins: langpacks, refresh-packagekit
Repository google-chrome is listed more than once in the configuration
fedora/19/x86_64/metalink                                                                                                                                                                   |  33 kB  00:00:00   <br/>
fedora                                                                                                                                                                                      | 4.2 kB  00:00:00   <br/>
fedora-chromium-stable                                                                                                                                                                      | 3.4 kB  00:00:00   <br/>
google-chrome                                                                                                                                                                               |  951 B  00:00:00   <br/>
rpmfusion-free                                                                                                                                                                              | 3.3 kB  00:00:00   <br/>
rpmfusion-free-updates                                                                                                                                                                      | 3.3 kB  00:00:00   <br/>
rpmfusion-nonfree                                                                                                                                                                           | 3.3 kB  00:00:00   <br/>
rpmfusion-nonfree-updates                                                                                                                                                                   | 3.3 kB  00:00:00   <br/>
updates/19/x86_64/metalink                                                                                                                                                                  |  30 kB  00:00:00   <br/>
updates                                                                                                                                                                                     | 4.4 kB  00:00:00   <br/>
zfs                                                                                                                                                                                         | 2.9 kB  00:00:00   <br/>
(1/6): fedora-chromium-stable/19/x86_64/primary_db                                                                                                                                          |  20 kB  00:00:00   <br/>
(2/6): zfs/19/x86_64/primary_db                                                                                                                                                             | 6.7 kB  00:00:00   <br/>
(3/6): updates/19/x86_64/group_gz                                                                                                                                                           | 385 kB  00:00:02   <br/>
(4/6): fedora/19/x86_64/group_gz                                                                                                                                                            | 384 kB  00:00:06   <br/>
(5/6): updates/19/x86_64/primary_db                                                                                                                                                         | 8.8 MB  00:01:53   <br/>
(6/6): fedora/19/x86_64/primary_db                                                                                                                                                          |  17 MB  00:03:34   <br/>
(1/10): google-chrome/primary                                                                                                                                                               | 1.9 kB  00:00:00   <br/>
(2/10): rpmfusion-free-updates/19/x86_64/primary_db                                                                                                                                         | 217 kB  00:00:01   <br/>
(3/10): rpmfusion-nonfree/19/x86_64/primary_db                                                                                                                                              | 149 kB  00:00:00   <br/>
(4/10): rpmfusion-free/19/x86_64/primary_db                                                                                                                                                 | 440 kB  00:00:03   <br/>
(5/10): rpmfusion-nonfree-updates/19/x86_64/primary_db                                                                              b                                                       |  97 kB  00:00:00   <br/>
(6/10): rpmfusion-nonfree-updates/19/x86_64/group_gz                                                                                                                                        |  990 B  00:00:05   <br/>
(7/10): rpmfusion-nonfree/19/x86_64/group_gz                                                                                                                                                |  993 B  00:00:07   <br/>
(8/10): rpmfusion-free/19/x86_64/group_gz                                                                                                                                                   | 1.6 kB  00:00:07   <br/>
(9/10): rpmfusion-free-updates/19/x86_64/group_gz                                                                                                                                           | 1.6 kB  00:00:07   <br/>
(10/10): updates/19/x86_64/updateinfo                                                                                                                                                       | 861 kB  00:00:09   <br/>
google-chrome                                                                                                                                                                                                  3/3
Resolving Dependencies
--> Running transaction check
---> Package dkms.noarch 0:2.2.0.3-14.zfs1.fc19 will be updated
--> Processing Dependency: dkms = 2.2.0.3-14.zfs1.fc19 for package: zfs-dkms-0.6.2-1.fc19.noarch
---> Package dkms.noarch 0:2.2.0.3-17.fc19 will be an update
--> Finished Dependency Resolution
Error: Package: zfs-dkms-0.6.2-1.fc19.noarch (@zfs)</p>

<pre><code>       Requires: dkms = 2.2.0.3-14.zfs1.fc19
       Removing: dkms-2.2.0.3-14.zfs1.fc19.noarch (@zfs)
           dkms = 2.2.0.3-14.zfs1.fc19
       Updated By: dkms-2.2.0.3-17.fc19.noarch (updates)
           dkms = 2.2.0.3-17.fc19
       Available: dkms-2.2.0.3-5.fc19.noarch (fedora)
           dkms = 2.2.0.3-5.fc19
</code></pre>

<p> You could try using --skip-broken to work around the problem
 You could try running: rpm -Va --nofiles --nodigest
[root@vicky etc]#
```</p>

<p>On another fedora system <code>yum update</code> worked fine, after reviewing the differences in the yum configuration it seems that <code>yum-plugin-priorities</code> wasn't installed on my box. After installing <code>yum-plugin-priorities</code></p>

<p>```
[root@vicky etc]# yum install yum-plugin-priorities
Loaded plugins: langpacks, refresh-packagekit
Repository google-chrome is listed more than once in the configuration
Resolving Dependencies
--> Running transaction check
---> Package yum-plugin-priorities.noarch 0:1.1.31-18.fc19 will be installed
--> Finished Dependency Resolution</p>

<p>Dependencies Resolved</p>

<p>===================================================================================================================================================================================================================</p>

<h1> Package                                                     Arch                                         Version                                              Repository                                     Size</h1>

<p>Installing:
 yum-plugin-priorities                                       noarch                                       1.1.31-18.fc19                                       updates                                        22 k</p>

<h1>Transaction Summary</h1>

<p>Install  1 Package</p>

<p>Total download size: 22 k
Installed size: 28 k
Is this ok [y/d/N]: y
Downloading packages:
yum-plugin-priorities-1.1.31-18.fc19.noarch.rpm                                                                                                                                             |  22 kB  00:00:01   <br/>
Running transaction check
Running transaction test
Transaction test succeeded
Running transaction
  Installing : yum-plugin-priorities-1.1.31-18.fc19.noarch                                                                                                                                                     1/1
  Verifying  : yum-plugin-priorities-1.1.31-18.fc19.noarch                                                                                                                                                     1/1</p>

<p>Installed:
  yum-plugin-priorities.noarch 0:1.1.31-18.fc19</p>

<p>Complete!
[root@vicky etc]#
```</p>

<p>And make sure that the zfs has the priority</p>

<p>```
[root@localhost etc]# cat yum.repos.d/zfs.repo
[zfs]
name=ZFS of Linux for Fedora $releasever
baseurl=http://archive.zfsonlinux.org/fedora/$releasever/$basearch/
enabled=1
priority=1
metadata_expire=7d
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-zfsonlinux
Requires:       yum-plugin-priorities</p>

<p>[zfs-source]
name=ZFS of Linux for Fedora $releasever - Source
baseurl=http://archive.zfsonlinux.org/fedora/$releasever/SRPMS/
enabled=0
metadata_expire=7d
gpgcheck=1
gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-zfsonlinux
[root@vicky etc]#
```</p>

<p> <code>yum update</code> works again.</p>

<p><code>
[root@vicky etc]# yum update -y
Loaded plugins: langpacks, priorities, refresh-packagekit
Repository google-chrome is listed more than once in the configuration
2 packages excluded due to repository priority protections
No packages marked for update
[root@vicky etc]#
</code></p>
]]></content>
  </entry>
  
</feed>

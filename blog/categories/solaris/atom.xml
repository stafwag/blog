<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: solaris | stafwag Blog]]></title>
  <link href="http://stafwag.github.io/blog/blog/categories/solaris/atom.xml" rel="self"/>
  <link href="http://stafwag.github.io/blog/"/>
  <updated>2013-10-13T20:30:42+02:00</updated>
  <id>http://stafwag.github.io/blog/</id>
  <author>
    <name><![CDATA[staf wagemakers]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Ide is still alive...]]></title>
    <link href="http://stafwag.github.io/blog/blog/2013/08/10/ide-is-still-alive/"/>
    <updated>2013-08-10T14:26:00+02:00</updated>
    <id>http://stafwag.github.io/blog/blog/2013/08/10/ide-is-still-alive</id>
    <content type="html"><![CDATA[<p><img class="right" src="/images/sta2ide_0.jpg" width="195" height="192" title="&#34;sta2ide&#34;" alt="&#34;sta2ide&#34;"></p>

<p>
The dvd drive in my <a href="http://en.wikipedia.org/wiki/Sun_Blade_(workstation)">sun blade 1500 workstation</a> broke down. I use this system acausally for some development, it's always handy to have a <a href="http://en.wikipedia.org/wiki/Endianness">big endian</a> system at hand.<br /><br />
</p>


<p>The dvd drive was still handy to load another operating system on it.<br />The dvd drive has an <a href="http://en.wikipedia.org/wiki/Integrated_Drive_Electronics">ide interface</a> which are hard to get these days...<br /><br />
<img class="left" src="/images/sata_dvd_0.jpg" width="326" height="245" title="&#34;dvd rom&#34;" alt="&#34;dvd rom&#34;"></p>

<p>
I found a <a href="http://www.conrad.be/ce/nl/product/974497/IDE-naar-SATA-converter/SHOP_AREA_37572">ide to sata convertor</a> and a <a href="http://www.conrad.be/ce/nl/product/417054/Samsung-DVD-ROM-SATA-SH-118ABBEBE-bulk/SHOP_AREA_17682">new dvd drive</a> with a <a href="http://en.wikipedia.org/wiki/Serial_ATA">sata interface</a> at <a href="http://www.conrad.be">conrad</a>. This should convert the sata interface to an ide interface without any driver and works with any operating system.<br /><br />Well let's put this to a test on a <a href="http://en.wikipedia.org/wiki/SPARC">sparc</a> system with <a href="http://en.wikipedia.org/wiki/Solaris_%28operating_system">solaris</a> :-)<br /><br />
</p>


<p><img class="right" src="/images/sata2dvdondvd_0.jpg" width="196" height="87" title="&#34;on dvd&#34;" alt="&#34;on dvd&#34;"></p>

<p>
The installation was pretty straightforward, luckily the dvd rom drive has a plastic back since the converter touches the back of the dvd rom drive.<br /><br />  
</p>


<p><img class="right" src="/images/sun1500_alive_0.jpg" width="326" height="244" title="&#34;sun 1500 alive&#34;" alt="&#34;sun 1500 alive&#34;"></p>

<p>
After a quick test it seems to work like a charm. I might install <a href="http://www.opensxce.org">opensxce</a> on it.<br /><br />It seems to be the only option to run an <a href="http://en.wikipedia.org/wiki/OpenSolaris">opensolaris</a> ancestor on sparc hardware.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ide is still alive...]]></title>
    <link href="http://stafwag.github.io/blog/blog/2013/08/10/ide-is-still-alive/"/>
    <updated>2013-08-10T14:26:00+02:00</updated>
    <id>http://stafwag.github.io/blog/blog/2013/08/10/ide-is-still-alive</id>
    <content type="html"><![CDATA[<p><img class="right" src="/images/sta2ide_0.jpg" width="195" height="192" title="&#34;sta2ide&#34;" alt="&#34;sta2ide&#34;"></p>

<p>
The dvd drive in my <a href="http://en.wikipedia.org/wiki/Sun_Blade_(workstation)">sun blade 1500 workstation</a> broke down. I use this system acausally for some development, it's always handy to have a <a href="http://en.wikipedia.org/wiki/Endianness">big endian</a> system at hand.<br /><br />
</p>


<p>The dvd drive was still handy to load another operating system on it.<br />The dvd drive has an <a href="http://en.wikipedia.org/wiki/Integrated_Drive_Electronics">ide interface</a> which are hard to get these days...<br /><br />
<img class="left" src="/images/sata_dvd_0.jpg" width="326" height="245" title="&#34;dvd rom&#34;" alt="&#34;dvd rom&#34;"></p>

<p>
I found a <a href="http://www.conrad.be/ce/nl/product/974497/IDE-naar-SATA-converter/SHOP_AREA_37572">ide to sata convertor</a> and a <a href="http://www.conrad.be/ce/nl/product/417054/Samsung-DVD-ROM-SATA-SH-118ABBEBE-bulk/SHOP_AREA_17682">new dvd drive</a> with a <a href="http://en.wikipedia.org/wiki/Serial_ATA">sata interface</a> at <a href="http://www.conrad.be">conrad</a>. This should convert the sata interface to an ide interface without any driver and works with any operating system.<br /><br />Well let's put this to a test on a <a href="http://en.wikipedia.org/wiki/SPARC">sparc</a> system with <a href="http://en.wikipedia.org/wiki/Solaris_%28operating_system">solaris</a> :-)<br /><br />
</p>


<p><img class="right" src="/images/sata2dvdondvd_0.jpg" width="196" height="87" title="&#34;on dvd&#34;" alt="&#34;on dvd&#34;"></p>

<p>
The installation was pretty straightforward, luckily the dvd rom drive has a plastic back since the converter touches the back of the dvd rom drive.<br /><br />  
</p>


<p><img class="right" src="/images/sun1500_alive_0.jpg" width="326" height="244" title="&#34;sun 1500 alive&#34;" alt="&#34;sun 1500 alive&#34;"></p>

<p>
After a quick test it seems to work like a charm. I might install <a href="http://www.opensxce.org">opensxce</a> on it.<br /><br />It seems to be the only option to run an <a href="http://en.wikipedia.org/wiki/OpenSolaris">opensolaris</a> ancestor on sparc hardware.</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Freebsd 9.1 jails with Qjail]]></title>
    <link href="http://stafwag.github.io/blog/blog/2013/02/16/freebsd-9.1-jails-with-qjail/"/>
    <updated>2013-02-16T12:35:00+01:00</updated>
    <id>http://stafwag.github.io/blog/blog/2013/02/16/freebsd-9.1-jails-with-qjail</id>
    <content type="html"><![CDATA[<hr />


<p><strong></p>

<p>I'm using <em>ezjail</em> <a href="http://stafwag.github.io/blog/blog/2013/04/10/migrating-from-qjail-to-ezjail/">now</a>.</p>

<p>The reason for this is that the <a href="http://www.freshports.org/sysutils/qjail">port</a> is marked as RESTRICTED.
Since it seems to be a fork from <a href="http://erdgeist.org/arts/software/ezjail/">ezjail</a> without respecting the copyright and license <a href="https://lists.freebsd.org/pipermail/freebsd-jail/2013-March/002149.html">https://lists.freebsd.org/pipermail/freebsd-jail/2013-March/002149.html</a>.</p>

<p></strong></p>

<hr />


<p>I'm adding more services to my <a href="http://stafwag.github.com/blog/blog/2012/12/16/running-freebsd-9.0-on-asus-c60m1-i-motherboard/">freebsd system</a></p>

<p>I'm coming from the <a href="http://en.wikipedia.org/wiki/Solaris_(operating_system)">solaris world</a> where it's a common practice to run services in separated <a href="http://en.wikipedia.org/wiki/Solaris_Containers">containers</a> for security reasons.</p>

<p>On FreeBSD there are <a href="http://en.wikipedia.org/wiki/FreeBSD_jail">jails</a> to isolate services and improve security.</p>

<p>At first I didn't like jails the way the <a href="http://www.freebsd.org/doc/handbook/jails.html">freebsd handbook</a> describes it requires a buildworld which takes a long time on my system with a AMD C-60 CPU.</p>

<p>Lucky <a href="http://sourceforge.net/projects/qjail/">Qjail</a> makes the deployment a lot easier.</p>

<h3>Installing Qjail</h3>

<p>```
[root@rataplan ~]# cd /usr/ports/sysutils/qjail/
[root@rataplan /usr/ports/sysutils/qjail]# make install clean
===>  License BSD accepted by the user
=> qjail-1.7.tar.bz2 doesn't seem to exist in /usr/ports/distfiles/.
=> Attempting to fetch http://heanet.dl.sourceforge.net/project/qjail/qjail-1.7.tar.bz2
qjail-1.7.tar.bz2                             100% of   39 kB  139 kBps
===>  Extracting for qjail-1.7
=> SHA256 Checksum OK for qjail-1.7.tar.bz2.
===>  Patching for qjail-1.7
===>  Configuring for qjail-1.7
===>  Installing for qjail-1.7
===>   Generating temporary packing list
===>  Checking if sysutils/qjail already installed
#
Use the qjail utility to deploy small or large numbers of jails quickly.</p>

<p>First issue "rehash" command to enable the qjail command (if using csh).
Then issue "man qjail-intro" to read the qjail introduction.
After reading that do "man qjail" for the usage details.
#
===>   Compressing manual pages for qjail-1.7
===>   Registering installation for qjail-1.7
===>  Cleaning for qjail-1.7
[root@rataplan /usr/ports/sysutils/qjail]#
```</p>

<h3>Create /usr/jails</h3>

<p><code>
[root@rataplan ~]# zfs create zroot/usr/jails
</code></p>

<h3>mount the freebsd 9.1 dvd</h3>

<p><code>
root@rataplan:/root # mount_cd9660 /dev/cd0 /mnt/
</code></p>

<h3>qjail install</h3>

<p>```
root@rataplan:/root # qjail install -f /mnt/usr/freebsd-dist/</p>

<p>The base RELEASE distribution files are populating the fulljail.
Est LT 1 minute elapse time for this to complete.</p>

<p>The lib32 RELEASE distribution files are populating the fulljail.
Est LT 1 minute elapse time for this to complete.</p>

<p>Basejail &amp; newjail are being populated.
Est LT 1 minute elapse time for this to complete.</p>

<p>Successfully installed qjail system.</p>

<p>root@rataplan:/root #</p>

<p>```</p>

<h3>Creating a zfs filesystem for the jail</h3>

<p>```
root@rataplan:/usr/local/etc # zfs create zroot/usr/jails/stafdb
root@rataplan:/usr/local/etc #</p>

<p>```</p>

<h3>Creating a jail with Qjail</h3>

<p><code>
[root@rataplan ~]# qjail create -n re0 stafdb 192.168.1.43
Successfully created  stafdb
[root@rataplan ~]#
</code></p>

<h3>Start the jail</h3>

<p><code>
root@rataplan:/usr/local/etc # qjail start stafdb
Jail started successfully. stafdb
root@rataplan:/usr/local/etc #
</code></p>

<h3>List the jails</h3>

<p>```
root@rataplan:/usr/local/etc # qjail list</p>

<p>STA JID  NIC IP              Jailname</p>

<hr />

<p>DR  4    re0 192.168.1.42    stafmail
DR  3    re0 192.168.1.41    staffs
DR  6    re0 192.168.1.43    stafdb</p>

<p>root@rataplan:/usr/local/etc #</p>

<p>```</p>

<h3>console access</h3>

<p>```
root@rataplan:/usr/local/etc # qjail console stafdb
Last login: Sat Feb 23 16:19:32 on pts/0
FreeBSD 9.1-RELEASE (GENERIC) #0 r244912: Tue Jan  1 14:13:25 CET 2013</p>

<p>Welcome to your FreeBSD jail
stafdb /root >
```</p>

<h3>install the freebsd ports to the jail</h3>

<p>```
root@rataplan:/usr/local/etc # qjail update -p stafdb</p>

<p>Sat Feb 23 16:21:55 CET 2013</p>

<p>The elapse download time of the portsnap compressed ports file
is estimated at 25 minutes for the initial fetch.
Subsequent fetches will generally take less than a minute.</p>

<p>Looking up portsnap.FreeBSD.org mirrors... 6 mirrors found.
Fetching snapshot tag from ec2-eu-west-1.portsnap.freebsd.org... done.
Fetching snapshot metadata... done.
Updating from Sat Feb 16 11:47:49 CET 2013 to Sat Feb 23 15:58:32 CET 2013.
Fetching 4 metadata patches... done.
Applying metadata patches... done.
Fetching 0 metadata files... done.
Fetching 524 patches.....10....20....30....40....50....60....70....80....90....100....110....120....130....140....150....160....170....180....190....200....210....220....230....240....250....260....270....280....290....300....310....320....330....340....350....360....370....380....390....400....410....420....430....440....450....460....470....480....490....500....510....520.. done.
Applying patches... done.
Fetching 42 new ports or files... done.
Portsnap fetch completed successfully</p>

<p>Sat Feb 23 16:22:40 CET 2013</p>

<p>The ports basejail/usr/ports directory tree is being updated.
The elapse time for this to complete is estimated at 1 minute
to 10 minutes depending on how current your ports system is.</p>

<p>Portsnap update completed successfully
root@rataplan:/usr/local/etc #
```</p>

<h3>update the base jail</h3>

<p>```
root@rataplan:/usr/local/etc # qjail stop
Jail stopped successfully. stafmail
Jail stopped successfully. staffs
Jail already stopped.      stafdb
root@rataplan:/usr/local/etc #</p>

<p>root@rataplan:/usr/local/etc # qjail update -b</p>

<p>Deletion of basejail binaries successful for bin.
Deletion of basejail binaries successful for lib.
Deletion of basejail binaries successful for libexec.
Deletion of basejail binaries successful for sbin.
Deletion of basejail binaries successful for usr/bin.
Deletion of basejail binaries successful for usr/include.
Deletion of basejail binaries successful for usr/lib.
Deletion of basejail binaries successful for usr/libdata.
Deletion of basejail binaries successful for usr/libexec.
Deletion of basejail binaries successful for usr/sbin.
Deletion of basejail binaries successful for usr/lib32.</p>

<p>Copied host's binaries to basejail successfully for bin.
Copied host's binaries to basejail successfully for lib.
Copied host's binaries to basejail successfully for libexec.
Copied host's binaries to basejail successfully for sbin.
Copied host's binaries to basejail successfully for usr/bin.
Copied host's binaries to basejail successfully for usr/include.
Copied host's binaries to basejail successfully for usr/lib.
Copied host's binaries to basejail successfully for usr/libdata.
Copied host's binaries to basejail successfully for usr/libexec.
Copied host's binaries to basejail successfully for usr/sbin.
Copied host's binaries to basejail successfully for usr/lib32.</p>

<p>Host to basejail binaries update completed successfully.
root@rataplan:/usr/local/etc #</p>

<p>root@rataplan:/usr/local/etc # qjail start
Jail started successfully. stafmail
Jail started successfully. staffs
Jail started successfully. stafdb
root@rataplan:/usr/local/etc #</p>

<p>```</p>

<h3>update /etc/rc.conf</h3>

<p>```
#</p>

<h1>qjails</h1>

<p>#</p>

<p>qjail_enable="YES"</p>

<p>```</p>
]]></content>
  </entry>
  
</feed>
